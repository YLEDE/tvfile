].split("&")[0];let douban_api_host="http://api.douban.com/api/v2";let miniapp_apikey="0ac44ae016490db2204ce0a042db2916";const count=30;function miniapp_request(path,query){try{let url=douban_api_host+path;query.apikey=miniapp_apikey;fetch_params.headers=oheaders;url=buildUrl(url,query);let html=fetch(url,fetch_params);if(/request_error/.test(html)){print(html)}return JSON.parse(html)}catch(e){print("发生了错误:"+e.message);return{}}}function cate_filter(d,douban){douban=douban||"";try{let res={};if(MY_CATE==="interests"){if(douban){let status=MY_FL.status||"mark";let subtype_tag=MY_FL.subtype_tag||"";let year_tag=MY_FL.year_tag||"全部";let path="/user/"+douban+"/interests";res=miniapp_request(path,{type:"movie",status:status,subtype_tag:subtype_tag,year_tag:year_tag,start:(MY_PAGE-1)*count,count:count})}else{return{}}}else if(MY_CATE==="hot_gaia"){let sort=MY_FL.sort||"recommend";let area=MY_FL.area||"全部";let path="/movie/"+MY_CATE;res=miniapp_request(path,{area:area,sort:sort,start:(MY_PAGE-1)*count,count:count})}else if(MY_CATE==="tv_hot"||MY_CATE==="show_hot"){let stype=MY_FL.type||MY_CATE;let path="/subject_collection/"+stype+"/items";res=miniapp_request(path,{start:(MY_PAGE-1)*count,count:count})}else if(MY_CATE.startsWith("rank_list")){let id=MY_CATE==="rank_list_movie"?"movie_real_time_hotest":"tv_real_time_hotest";id=MY_FL.榜单||id;let path="/subject_collection/"+id+"/items";res=miniapp_request(path,{start:(MY_PAGE-1)*count,count:count})}else{let path="/"+MY_CATE+"/recommend";let selected_categories;let tags;let sort;if(Object.keys(MY_FL).length>0){sort=MY_FL.sort||"T";tags=Object.values(MY_FL).join(",");if(MY_CATE==="movie"){selected_categories={"类型":MY_FL.类型||"","地区":MY_FL.地区||""}}else{selected_categories={"类型":MY_FL.类型||"","形式":MY_FL.类型?MY_FL.类型+"地区":"","地区":MY_FL.地区||""}}}else{sort="T";tags="";if(MY_CATE==="movie"){selected_categories={"类型":"","地区":""}}else{selected_categories={"类型":"","形式":"","地区":""}}}let params={tags:tags,sort:sort,refresh:0,selected_categories:stringify(selected_categories),start:(MY_PAGE-1)*count,count:count};res=miniapp_request(path,params)}let result={page:MY_PAGE,pagecount:Math.ceil(res.total/count),limit:count,total:res.total};let items=[];if(/^rank_list|tv_hot|show_hot/.test(MY_CATE)){items=res["subject_collection_items"]}else if(MY_CATE==="interests"){res["interests"].forEach(function(it){items.push(it.subject)})}else{items=res.items}let lists=[];items.forEach(function(item){if(item.type==="movie"||item.type==="tv"){let rating=item.rating?item.rating.value:"";let rat_str=rating||"暂无评分";let title=item.title;let honor=item.honor_infos||[];let honor_str=honor.map(function(it){return it.title}).join("|");let vod_obj={vod_name:title!=="未知电影"?title:"暂不支持展示",vod_pic:item.pic.normal,vod_remarks:rat_str+" "+honor_str};let vod_obj_d={url:item.type+"$"+item.id,title:title!=="未知电影"?title:"暂不支持展示",pic_url:item.pic.normal,desc:rat_str+" "+honor_str};lists.push(vod_obj);d.push(vod_obj_d)}});result.list=lists;return result}catch(e){print(e.message)}return{}}let res=cate_filter(d,douban);setResult2(res) {"class":[{"type_id":"hot_gaia","type_name":"\u70ed\u95e8\u7535\u5f71"},{"type_id":"tv_hot","type_name":"\u70ed\u64ad\u5267\u96c6"},{"type_id":"show_hot","type_name":"\u70ed\u64ad\u7efc\u827a"},{"type_id":"movie","type_name":"\u7535\u5f71\u7b5b\u9009"},{"type_id":"tv","type_name":"\u7535\u89c6\u7b5b\u9009"},{"type_id":"rank_list_movie","type_name":"\u7535\u5f71\u699c\u5355"},{"type_id":"rank_list_tv","type_name":"\u7535\u89c6\u699c\u5355"}],"filters":{"hot_gaia":[{"key":"sort","name":"\u6392\u5e8f","value":[{"n":"\u70ed\u5ea6","v":"recommend"},{"n":"\u6700\u65b0","v":"time"},{"n":"\u8bc4\u5206","v":"rank"}]},{"key":"area","name":"\u5730\u533a","value":[{"n":"\u5168\u90e8","v":"\u5168\u90e8"},{"n":"\u534e\u8bed","v":"\u534e\u8bed"},{"n":"\u6b27\u7f8e","v":"\u6b27\u7f8e"},{"n":"\u97e9\u56fd","v":"\u97e9\u56fd"},{"n":"\u65e5\u672c","v":"\u65e5\u672c"}]}],"movie":[{"key":"\u7c7b\u578b","name":"\u7c7b\u578b","value":[{"n":"\u5168\u90e8\u7c7b\u578b","v":""},{"n":"\u559c\u5267","v":"\u559c\u5267"},{"n":"\u7231\u60c5","v":"\u7231\u60c5"},{"n":"\u52a8\u4f5c","v":"\u52a8\u4f5c"},{"n":"\u79d1\u5e7b","v":"\u79d1\u5e7b"},{"n":"\u52a8\u753b","v":"\u52a8\u753b"},{"n":"\u60ac\u7591","v":"\u60ac\u7591"},{"n":"\u72af\u7f6a","v":"\u72af\u7f6a"},{"n":"\u60ca\u609a","v":"\u60ca\u609a"},{"n":"\u5192\u9669","v":"\u5192\u9669"},{"n":"\u97f3\u4e50","v":"\u97f3\u4e50"},{"n":"\u5386\u53f2","v":"\u5386\u53f2"},{"n":"\u5947\u5e7b","v":"\u5947\u5e7b"},{"n":"\u6050\u6016","v":"\u6050\u6016"},{"n":"\u6218\u4e89","v":"\u6218\u4e89"},{"n":"\u4f20\u8bb0","v":"\u4f20\u8bb0"},{"n":"\u6b4c\u821e","v":"\u6b4c\u821e"},{"n":"\u6b66\u4fa0","v":"\u6b66\u4fa0"},{"n":"\u60c5\u8272","v":"\u60c5\u8272"},{"n":"\u707e\u96be","v":"\u707e\u96be"},{"n":"\u897f\u90e8","v":"\u897f\u90e8"},{"n":"\u7eaa\u5f55\u7247","v":"\u7eaa\u5f55\u7247"},{"n":"\u77ed\u7247","v":"\u77ed\u7247"}]},{"key":"\u5730\u533a","name":"\u5730\u533a","value":[{"n":"\u5168\u90e8\u5730\u533a","v":""},{"n":"\u534e\u8bed","v":"\u534e\u8bed"},{"n":"\u6b27\u7f8e","v":"\u6b27\u7f8e"},{"n":"\u97e9\u56fd","v":"\u97e9\u56fd"},{"n":"\u65e5\u672c","v":"\u65e5\u672c"},{"n":"\u4e2d\u56fd\u5927\u9646","v":"\u4e2d\u56fd\u5927\u9646"},{"n":"\u7f8e\u56fd","v":"\u7f8e\u56fd"},{"n":"\u4e2d\u56fd\u9999\u6e2f","v":"\u4e2d\u56fd\u9999\u6e2f"},{"n":"\u4e2d\u56fd\u53f0\u6e7e","v":"\u4e2d\u56fd\u53f0\u6e7e"},{"n":"\u82f1\u56fd","v":"\u82f1\u56fd"},{"n":"\u6cd5\u56fd","v":"\u6cd5\u56fd"},{"n":"\u5fb7\u56fd","v":"\u5fb7\u56fd"},{"n":"\u610f\u5927\u5229","v":"\u610f\u5927\u5229"},{"n":"\u897f\u73ed\u7259","v":"\u897f\u73ed\u7259"},{"n":"\u5370\u5ea6","v":"\u5370\u5ea6"},{"n":"\u6cf0\u56fd","v":"\u6cf0\u56fd"},{"n":"\u4fc4\u7f57\u65af","v":"\u4fc4\u7f57\u65af"},{"n":"\u52a0\u62ff\u5927","v":"\u52a0\u62ff\u5927"},{"n":"\u6fb3\u5927\u5229\u4e9a","v":"\u6fb3\u5927\u5229\u4e9a"},{"n":"\u7231\u5c14\u5170","v":"\u7231\u5c14\u5170"},{"n":"\u745e\u5178","v":"\u745e\u5178"},{"n":"\u5df4\u897f","v":"\u5df4\u897f"},{"n":"\u4e39\u9ea6","v":"\u4e39\u9ea6"}]},{"key":"sort","name":"\u6392\u5e8f","value":[{"n":"\u8fd1\u671f\u70ed\u5ea6","v":"T"},{"n":"\u9996\u6620\u65f6\u95f4","v":"R"},{"n":"\u9ad8\u5206\u4f18\u5148","v":"S"}]},{"key":"\u5e74\u4ee3","name":"\u5e74\u4ee3","value":[{"n":"\u5168\u90e8\u5e74\u4ee3","v":""},{"n":"2022","v":"2022"},{"n":"2021","v":"2021"},{"n":"2020","v":"2020"},{"n":"2019","v":"2019"},{"n":"2010\u5e74\u4ee3","v":"2010\u5e74\u4ee3"},{"n":"2000\u5e74\u4ee3","v":"2000\u5e74\u4ee3"},{"n":"90\u5e74\u4ee3","v":"90\u5e74\u4ee3"},{"n":"80\u5e74\u4ee3","v":"80\u5e74\u4ee3"},{"n":"70\u5e74\u4ee3","v":"70\u5e74\u4ee3"},{"n":"60\u5e74\u4ee3","v":"60\u5e74\u4ee3"},{"n":"\u66f4\u65e9","v":"\u66f4\u65e9"}]}],"rank_list_movie":[{"key":"\u699c\u5355","name":"\u699c\u5355","value":[{"n":"\u5b9e\u65f6\u70ed\u95e8\u7535\u5f71","v":"movie_real_time_hotest"},{"n":"\u4e00\u5468\u53e3\u7891\u7535\u5f71\u699c","v":"movie_weekly_best"},{"n":"\u8c46\u74e3\u7535\u5f71Top250","v":"movie_top250"}]}],"rank_list_tv":[{"key":"\u699c\u5355","name":"\u699c\u5355","value":[{"n":"\u5b9e\u65f6\u70ed\u95e8\u7535\u89c6","v":"tv_real_time_hotest"},{"n":"\u534e\u8bed\u53e3\u7891\u5267\u96c6\u699c","v":"tv_chinese_best_weekly"},{"n":"\u5168\u7403\u53e3\u7891\u5267\u96c6\u699c","v":"tv_global_best_weekly"},{"n":"\u56fd\u5185\u53e3\u7891\u7efc\u827a\u699c","v":"show_chinese_best_weekly"},{"n":"\u56fd\u5916\u53e3\u7891\u7efc\u827a\u699c","v":"show_global_best_weekly"}]}],"show_hot":[{"key":"type","name":"\u5206\u7c7b","value":[{"n":"\u7efc\u5408","v":"show_hot"},{"n":"\u56fd\u5185","v":"show_domestic"},{"n":"\u56fd\u5916","v":"show_foreign"}]}],"tv":[{"key":"\u7c7b\u578b","name":"\u7c7b\u578b","value":[{"n":"\u4e0d\u9650","v":""},{"n":"\u7535\u89c6\u5267","v":"\u7535\u89c6\u5267"},{"n":"\u7efc\u827a","v":"\u7efc\u827a"}]},{"key":"\u7535\u89c6\u5267\u5f62\u5f0f","name":"\u7535\u89c6\u5267\u5f62\u5f0f","value":[{"n":"\u4e0d\u9650","v":""},{"n":"\u559c\u5267","v":"\u559c\u5267"},{"n":"\u7231\u60c5","v":"\u7231\u60c5"},{"n":"\u60ac\u7591","v":"\u60ac\u7591"},{"n":"\u52a8\u753b","v":"\u52a8\u753b"},{"n":"\u6b66\u4fa0","v":"\u6b66\u4fa0"},{"n":"\u53e4\u88c5","v":"\u53e4\u88c5"},{"n":"\u5bb6\u5ead","v":"\u5bb6\u5ead"},{"n":"\u72af\u7f6a","v":"\u72af\u7f6a"},{"n":"\u79d1\u5e7b","v":"\u79d1\u5e7b"},{"n":"\u6050\u6016","v":"\u6050\u6016"},{"n":"\u5386\u53f2","v":"\u5386\u53f2"},{"n":"\u6218\u4e89","v":"\u6218\u4e89"},{"n":"\u52a8\u4f5c","v":"\u52a8\u4f5c"},{"n":"\u5192\u9669","v":"\u5192\u9669"},{"n":"\u4f20\u8bb0","v":"\u4f20\u8bb0"},{"n":"\u5267\u60c5","v":"\u5267\u60c5"},{"n":"\u5947\u5e7b","v":"\u5947\u5e7b"},{"n":"\u60ca\u609a","v":"\u60ca\u609a"},{"n":"\u707e\u96be","v":"\u707e\u96be"},{"n":"\u6b4c\u821e","v":"\u6b4c\u821e"},{"n":"\u97f3\u4e50","v":"\u97f3\u4e50"}]},{"key":"\u7efc\u827a\u5f62\u5f0f","name":"\u7efc\u827a\u5f62\u5f0f","value":[{"n":"\u4e0d\u9650","v":""},{"n":"\u771f\u4eba\u79c0","v":"\u771f\u4eba\u79c0"},{"n":"\u8131\u53e3\u79c0","v":"\u8131\u53e3\u79c0"},{"n":"\u97f3\u4e50","v":"\u97f3\u4e50"},{"n":"\u6b4c\u821e","v":"\u6b4c\u821e"}]},{"key":"\u5730\u533a","name":"\u5730\u533a","value":[{"n":"\u5168\u90e8\u5730\u533a","v":""},{"n":"\u534e\u8bed","v":"\u534e\u8bed"},{"n":"\u6b27\u7f8e","v":"\u6b27\u7f8e"},{"n":"\u56fd\u5916","v":"\u56fd\u5916"},{"n":"\u97e9\u56fd","v":"\u97e9\u56fd"},{"n":"\u65e5\u672c","v":"\u65e5\u672c"},{"n":"\u4e2d\u56fd\u5927\u9646","v":"\u4e2d\u56fd\u5927\u9646"},{"n":"\u4e2d\u56fd\u9999\u6e2f","v":"\u4e2d\u56fd\u9999\u6e2f"},{"n":"\u7f8e\u56fd","v":"\u7f8e\u56fd"},{"n":"\u82f1\u56fd","v":"\u82f1\u56fd"},{"n":"\u6cf0\u56fd","v":"\u6cf0\u56fd"},{"n":"\u4e2d\u56fd\u53f0\u6e7e","v":"\u4e2d\u56fd\u53f0\u6e7e"},{"n":"\u610f\u5927\u5229","v":"\u610f\u5927\u5229"},{"n":"\u6cd5\u56fd","v":"\u6cd5\u56fd"},{"n":"\u5fb7\u56fd","v":"\u5fb7\u56fd"},{"n":"\u897f\u73ed\u7259","v":"\u897f\u73ed\u7259"},{"n":"\u4fc4\u7f57\u65af","v":"\u4fc4\u7f57\u65af"},{"n":"\u745e\u5178","v":"\u745e\u5178"},{"n":"\u5df4\u897f","v":"\u5df4\u897f"},{"n":"\u4e39\u9ea6","v":"\u4e39\u9ea6"},{"n":"\u5370\u5ea6","v":"\u5370\u5ea6"},{"n":"\u52a0\u62ff\u5927","v":"\u52a0\u62ff\u5927"},{"n":"\u7231\u5c14\u5170","v":"\u7231\u5c14\u5170"},{"n":"\u6fb3\u5927\u5229\u4e9a","v":"\u6fb3\u5927\u5229\u4e9a"}]},{"key":"sort","name":"\u6392\u5e8f","value":[{"n":"\u8fd1\u671f\u70ed\u5ea6","v":"T"},{"n":"\u9996\u64ad\u65f6\u95f4","v":"R"},{"n":"\u9ad8\u5206\u4f18\u5148","v":"S"}]},{"key":"\u5e74\u4ee3","name":"\u5e74\u4ee3","value":[{"n":"\u5168\u90e8","v":""},{"n":"2022","v":"2022"},{"n":"2021","v":"2021"},{"n":"2020","v":"2020"},{"n":"2019","v":"2019"},{"n":"2010\u5e74\u4ee3","v":"2010\u5e74\u4ee3"},{"n":"2000\u5e74\u4ee3","v":"2000\u5e74\u4ee3"},{"n":"90\u5e74\u4ee3","v":"90\u5e74\u4ee3"},{"n":"80\u5e74\u4ee3","v":"80\u5e74\u4ee3"},{"n":"70\u5e74\u4ee3","v":"70\u5e74\u4ee3"},{"n":"60\u5e74\u4ee3","v":"60\u5e74\u4ee3"},{"n":"\u66f4\u65e9","v":"\u66f4\u65e9"}]},{"key":"\u5e73\u53f0","name":"\u5e73\u53f0","value":[{"n":"\u5168\u90e8","v":""},{"n":"\u817e\u8baf\u89c6\u9891","v":"\u817e\u8baf\u89c6\u9891"},{"n":"\u7231\u5947\u827a","v":"\u7231\u5947\u827a"},{"n":"\u4f18\u9177","v":"\u4f18\u9177"},{"n":"\u6e56\u5357\u536b\u89c6","v":"\u6e56\u5357\u536b\u89c6"},{"n":"Netflix","v":"Netflix"},{"n":"HBO","v":"HBO"},{"n":"BBC","v":"BBC"},{"n":"NHK","v":"NHK"},{"n":"CBS","v":"CBS"},{"n":"NBC","v":"NBC"},{"n":"tvN","v":"tvN"}]}],"tv_hot":[{"key":"type","name":"\u5206\u7c7b","value":[{"n":"\u7efc\u5408","v":"tv_hot"},{"n":"\u56fd\u4ea7\u5267","v":"tv_domestic"},{"n":"\u6b27\u7f8e\u5267","v":"tv_american"},{"n":"\u65e5\u5267","v":"tv_japanese"},{"n":"\u97e9\u5267","v":"tv_korean"},{"n":"\u52a8\u753b","v":"tv_animation"}]}]},"list":[{"vod_id":"","vod_name":"\u4ed6\u662f\u8c01","vod_pic":"https://img1.doubanio.com/view/photo/s_ratio_poster/public/p2889190738.jpg","vod_remarks":"8.0 \u4e00\u5468\u534e\u8bed\u53e3\u7891\u5267\u96c6\u699c"},{"vod_id":"","vod_name":"\u94c3\u82bd\u4e4b\u65c5","vod_pic":"https://img2.doubanio.com/view/photo/s_ratio_poster/public/p2887641712.jpg","vod_remarks":"7.9 \u8fd1\u671f\u70ed\u95e8\u7535\u5f71\u699c"},{"vod_id":"","vod_name":"\u91cd\u542f\u4eba\u751f","vod_pic":"https://img2.doubanio.com/view/photo/s_ratio_poster/public/p2886331572.jpg","vod_remarks":"9.4 \u4e00\u5468\u5168\u7403\u53e3\u7891\u5267\u96c6\u699c"},{"vod_id":"","vod_name":"\u9ed1\u6697\u8363\u8000 \u7b2c\u4e8c\u5b63","vod_pic":"https://img1.doubanio.com/view/photo/s_ratio_poster/public/p2887693579.jpg","vod_remarks":"9.1 \u4e00\u5468\u5168\u7403\u53e3\u7891\u5267\u96c6\u699c"},{"vod_id":"","vod_name":"\u56de\u54cd","vod_pic":"https://img1.doubanio.com/view/photo/s_ratio_poster/public/p2889186157.jpg","vod_remarks":"6.3 "},{"vod_id":"","vod_name":"\u9ed1\u6697\u8363\u8000","vod_pic":"https://img1.doubanio.com/view/photo/s_ratio_poster/public/p2884876907.jpg","vod_remarks":"8.9 \u9ad8\u5206\u7ecf\u5178\u97e9\u5267\u699c"},{"vod_id":"","vod_name":"\u4fdd\u4f60\u5e73\u5b89","vod_pic":"https://img1.doubanio.com/view/photo/s_ratio_poster/public/p2889498097.jpg","vod_remarks":"7.8 "},{"vod_id":"","vod_name":"\u4e0d\u6b62\u4e0d\u4f11","vod_pic":"https://img9.doubanio.com/view/photo/s_ratio_poster/public/p2888743135.jpg","vod_remarks":"\u6682\u65e0\u8bc4\u5206 "},{"vod_id":"","vod_name":"\u8110\u5e26","vod_pic":"https://img2.doubanio.com/view/photo/s_ratio_poster/public/p2889236161.jpg","vod_remarks":"7.7 "},{"vod_id":"","vod_name":"\u5077\u81ea\u884c\u8f66\u7684\u4eba","vod_pic":"https://img2.doubanio.com/view/photo/s_ratio_poster/public/p759707912.jpg","vod_remarks":"9.1 \u610f\u5927\u5229\u72af\u7f6a\u7247\u699c"},{"vod_id":"","vod_name":"\u75be\u901f\u8ffd\u67404","vod_pic":"https://img9.doubanio.com/view/photo/s_ratio_poster/public/p2884692335.jpg","vod_remarks":"\u6682\u65e0\u8bc4\u5206 "},{"vod_id":"","vod_name":"\u4eba\u751f\u4e4b\u8def","vod_pic":"https://img2.doubanio.com/view/photo/s_ratio_poster/public/p2889400673.jpg","vod_remarks":"\u6682\u65e0\u8bc4\u5206 "},{"vod_id":"","vod_name":"\u6700\u540e\u751f\u8fd8\u8005 \u7b2c\u4e00\u5b63","vod_pic":"https://img9.doubanio.com/view/photo/s_ratio_poster/public/p2884221114.jpg","vod_remarks":"9.1 \u4e00\u5468\u5168\u7403\u53e3\u7891\u5267\u96c6\u699c"},{"vod_id":"","vod_name":"\u72c2\u98d9","vod_pic":"https://img2.doubanio.com/view/photo/s_ratio_poster/public/p2886376181.jpg","vod_remarks":"8.5 "},{"vod_id":"","vod_name":"\u6625\u95fa\u
